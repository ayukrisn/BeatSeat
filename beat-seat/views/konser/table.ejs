<!-- DataTales Example -->
<div class="card shadow mb-4">
  <% if( role === "Admin") { %>
    <div class="card-header py-3">
      <!-- Button trigger modal -->
      <button
        type="button"
        class="btn btn-outline-primary btn-sm"
        data-toggle="modal"
        data-target="#add-modal"
      >
        Add
      </button>
    </div>
    <% } %>
    <div class="card-body">
      <div class="table-responsive">
        <table
          class="table table-bordered"
          id="dataTable"
          width="100%"
          cellspacing="0"
        >
          <thead>
            <tr>
              <th onclick="sortTable(0)" class="sortable">No</th>
              <th onclick="sortTable(1)" class="sortable">Konser</th>
              <th onclick="sortTable(2)" class="sortable">Kategori</th>
              <th onclick="sortTable(3)" class="sortable">Deskripsi</th>
              <th onclick="sortTable(4)" class="sortable">Status</th>
              <th onclick="sortTable(5)" class="sortable">Alamat</th>
              <th onclick="sortTable(6)" class="sortable">Waktu</th>
              <% if( role === "Admin") { %>
              <th>Action</th>
              <% } %>
            </tr>
          </thead>
          <tbody>
            <% for(let i = 0; i < konser.length; i++) { %>
            <tr>
              <td onclick="sortTable(0)"><%= i +1 %></td>
              <td><%= konser[i].namaKonser %></td>
              <td><%= konser[i].kategoriKonser %></td>
              <td><%= konser[i].deskripsiKonser %></td>
              <td><%= konser[i].statusKonser %></td>
              <td><%= konser[i].alamatKonser %></td>
              <td><%= konser[i].waktuKonser %></td>
              <% if( role === "Admin") { %>
              <td class="text-center">
                <form
                  action="/konser/<%= konser[i].id %>?_method=DELETE"
                  method="POST"
                >
                <!-- data-nama di bawah akan dikirim pada form input pada modal-edit, dengan
                    data dari tabel konser array[i] mengambil kolom pada database-->
                <a 
                   href="javascript:void()"
                   class="btn btn-outline-warning btn-sm button-update"
                   data-id="<%= konser[i].id %>"
                   data-namaKonser="<%= konser[i].namaKonser %>"
                   data-kategoriKonser="<%= konser[i].kategoriKonser %>"
                   data-deskripsiKonser="<%= konser[i].deskripsiKonser %>"
                   data-statusKonser="<%= konser[i].statusKonser %>"
                   data-alamatKonser="<%= konser[i].alamatKonser %>"
                   data-waktuKonser="<%= konser[i].waktuKonser %>"
                  >Edit</a>
                <button 
                  type="submit" 
                  class="btn btn-outline-danger btn-sm"
                  onclick="return confirm('Apakah Anda yakin ingin menghapus data konser ini?');"
                  >
                  Delete
                </button>
              </form>
              </td>
              <% } %>
            </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <style>
    .sortable {
      cursor: pointer;
      position: relative;
    }
    
    .sortable:after {
      content: '';
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 5px solid #ccc;
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }
    
    .sortable.asc:after {
      border-top: 0;
      border-bottom: 5px solid #ccc;
      opacity: 1;
    }
    
    .sortable.desc:after {
      border-top: 5px solid #ccc;
      border-bottom: 0;
      opacity: 1;
    }
    
    .sortable.asc {
      background-color: #eaeaea;
    }
    
    .sortable.desc {
      background-color: #f5f5f5;
    }
    </style>
    
    <script>
    function sortTable(n) {
      var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
      table = document.getElementById("dataTable");
      switching = true;
      dir = "asc";
      while (switching) {
        switching = false;
        rows = table.rows;
        for (i = 1; i < rows.length - 1; i++) {
          shouldSwitch = false;
          x = rows[i].getElementsByTagName("TD")[n];
          y = rows[i + 1].getElementsByTagName("TD")[n];
          if (n != 0) {
            if (dir == "asc") {
              if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                shouldSwitch = true;
                break;
              }
            } else if (dir == "desc") {
              if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                shouldSwitch = true;
                break;
              }
            }
          } else {
            if (dir == "asc") {
              if (Number(x.innerHTML) > Number(y.innerHTML)) {
                shouldSwitch = true;
                break;
              }
            } else if (dir == "desc") {
              if (Number(x.innerHTML) < Number(y.innerHTML)) {
                shouldSwitch = true;
                break;
              }
            }
          }
        }
        if (shouldSwitch) {
          rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
          switching = true;
          switchcount++;
        } else {
          if (switchcount == 0 && dir == "asc") {
            dir = "desc";
            switching = true;
          }
        }
      }
    
      // Remove sorting classes from all columns
      var thElements = table.getElementsByTagName("th");
      for (var j = 0; j < thElements.length; j++) {
        thElements[j].classList.remove("asc");
        thElements[j].classList.remove("desc");
      }
    
      // Add sorting class to the clicked column
      thElements[n].classList.toggle("asc", dir === "asc");
      thElements[n].classList.toggle("desc", dir === "desc");
    }
    </script>    